setwd("C:/Users/SANDIPAN DEY/Desktop/Edx")
library(Rglpk)

read.csv("EvenStarFarm.csv")

## R1..8 C1..8 F1..8 : #cases of 8 produces to sell through 3 channels
# max 40*R1 + 26*R2 + .. + 36*R8 + 36*C1 + 36*C2 + .. + 36*C8 + 38.25*F1 + 34*F2 + .. + 36*F8 - 214.40*(R1+R2+..+R8)/119 - 31.68*(36*C1+36*C2+..+36*C8)/400 - 0 - 1,495.50 - 730.50 - 5,833.50 
# max  37.97983*R1 + 23.97983*R2 + .. + 33.97983*R8 + 35.9208*C1 + 35.9208*C2 + ... + 35.9208*C8 + 38.25*F1 + 34.00*F2 + ... + 36.00*F8  - 8059.5
# s.t.
# R1 + C1 + F1 <= 406
# R2 + C2 + F2 <= 608
# R3 + C3 + F3 <= 167
# R4 + C4 + F4 <= 76
# R5 + C5 + F5 <= 72
# R6 + C6 + F6 <= 251
# R7 + C7 + F7 <= 107
# R8 + C8 + F8 <= 133
# F1 + F2 + .. + F8 <= 600
# (R1 + R2 + .. + R8) / 119 <= 20
# (36*C1+36*C2+..+36*C8)/400 <= 90

(1 - 31.68 / 400) * c(36.00, 36.00, 20.00, 36.00, 24.00, 24.00, 36.00, 36.00)
     
obj <- c(c(40.00, 26.00, 20.00, 24.00, 18.00, 24.00, 36.00, 36.00) - 214.40/119,
		(1 - 31.68 / 400) * c(36.00, 36.00, 20.00, 36.00, 24.00, 24.00, 36.00, 36.00),
		 38.25,34.00,20.25,34.00,21.25,25.20,36.00,36.00)

#obj <- round(obj, 2)

mat <- matrix(c(1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
				0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
				0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
				0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
				0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
				0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
				0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0,
				0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1,
				1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0.09, 0.09, 0.05, 0.09, 0.06, 0.06, 0.09, 0.09, 0, 0, 0, 0, 0, 0, 0, 0), nrow = 11, byrow=TRUE)

dir <- c("<=", "<=", "<=", "<=", "<=", "<=", "<=", "<=", "<=", "<=", "<=")
rhs <- c(406, 608, 167, 76, 72, 251, 107, 133, 600, 119*20, 90)
max <- TRUE

sol <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
sol
sol$optimum - 8059.5
soln <- as.data.frame(matrix(sol$solution, nrow=3, byrow=TRUE))
rownames(soln) <- c("Restaurant", "CSA", "Farmer")
names(soln) <- c("Tomatoes (large)","Tomatoes (small)","Watermelon","Okra","Basil","Cucumbers","Sweet Potatoes","Winter Squash")
soln

soln$CSA

length(sol$solution)		 
sol$solution[1] + sol$solution[9] + sol$solution[17] # large tomato
sol$solution[9] # large tomato CSA
sol$solution[19] # watermelon Farmer
C1 = sol$solution[9]
C2 = sol$solution[10]
C3 = sol$solution[11]
C4 = sol$solution[12]
C5 = sol$solution[13]
C6 = sol$solution[14]
C7 = sol$solution[15]
C8 = sol$solution[16]
(36.00*C1+36.00*C2+20.00*C3+36.00*C4+24.00*C5+24.00*C6+36.00*C7+36.00*C8)/400 # #CSA customers
65.88*400
# 26352/65 == 405.4154
# 26352/66 == 399.2727

rhs <- c(406, 608, 167, 76, 72, 251, 107, 133, 600 + 200, 119*20, 90)
sol1 <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
sol1
sol1$optimum - 8059.5
sol$optimum - 8059.5
sol1$optimum - sol$optimum
1000

rhs <- c(406, 608, 167, 76, 72, 251, 107, 133, 600, 119*20, 100)
#rhs <- c(406, 608, 167, 76, 72, 251, 107, 133, 600, 119*20, 95)
sol1 <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
sol1
sol1$optimum - 8059.5
sol$optimum - 8059.5
sol1$optimum - sol$optimum

rhs <- c(406, 608, 167, 76, 72, 251, 107, 133, 600, 119*20, 90)
for (i in 1:8) {
	rhs[i] <- rhs[i] + 10
	sol1 <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
	print(paste(names(soln)[i], sol1$optimum - 8059.5))
	rhs[i] <- rhs[i] - 10
}

sol$optimum - 8059.5

read.csv("Investment.csv")

## sell: Y + G + M + B + J + C + I + P
# max 29.5*(150-Y) + 26.31*(150-G) + 34.55*(150-M) + 15.23*(150-B) + 62.43*(150-J) + 26.68*(150-C) + 23.85*(150-I) + 31.66*(150-P)
# max 37531.5 - 29.5*Y - 26.31*G - 34.55*M - 15.23*B - 62.43*J - 26.68*C - 23.85*I - 31.66*P
# 37531.5 - min 29.5*Y + 26.31*G + 34.55*M + 15.23*B + 62.43*J + 26.68*C + 23.85*I + 31.66*P
# s.t.
# 0 <= Y, G, M, B, J, C, I, P <= 150
# C*Y - 0.3*(C-P)*Y - 0.01*C*Y = (0.69*C + 0.3*P)*Y
# (0.69*31.8 + 0.3*15.68)*Y + (0.69*24.28 + 0.3*22.1)*G + (0.69*32.5 + 0.3*30.39)*M + (0.69*14.16 + 0.3*8.93)*B + (0.69*50.99 + 0.3*40.55)*J +
# (0.69*24.17 + 0.3*18.58)*C + (0.69*23.67 + 0.3*22.54)*I + (0.69*28.77 + 0.3*24.84)*P = 10000

obj <- c(29.5, 26.31, 34.55, 15.23, 62.43, 26.68, 23.85, 31.66)
mat <- matrix(c(1, 0, 0, 0, 0, 0, 0, 0,
				0, 1, 0, 0, 0, 0, 0, 0,
				0, 0, 1, 0, 0, 0, 0, 0,
				0, 0, 0, 1, 0, 0, 0, 0,
				0, 0, 0, 0, 1, 0, 0, 0,
				0, 0, 0, 0, 0, 1, 0, 0,
				0, 0, 0, 0, 0, 0, 1, 0,
				0, 0, 0, 0, 0, 0, 0, 1,
				(0.69*31.8 + 0.3*15.68), (0.69*24.28 + 0.3*22.1), (0.69*32.5 + 0.3*30.39), (0.69*14.16 + 0.3*8.93), 
				(0.69*50.99 + 0.3*40.55), (0.69*24.17 + 0.3*18.58), (0.69*23.67 + 0.3*22.54), (0.69*28.77 + 0.3*24.84)), nrow = 9, byrow=TRUE)
dir <- c("<=", "<=", "<=", "<=", "<=", "<=", "<=", "<=", "==")
rhs <- c(150, 150, 150, 150, 150, 150, 150, 150, 10000)
max <- FALSE
Rglpk_solve_LP(obj, mat, dir, rhs, max = max)

obj <- c(29.5, 26.31, 34.55, 15.23, 62.43, 26.68, 23.85, 31.66)
mat <- matrix(c(1, 0, 0, 0, 0, 0, 0, 0,
				0, 1, 0, 0, 0, 0, 0, 0,
				0, 0, 1, 0, 0, 0, 0, 0,
				0, 0, 0, 1, 0, 0, 0, 0,
				0, 0, 0, 0, 1, 0, 0, 0,
				0, 0, 0, 0, 0, 1, 0, 0,
				0, 0, 0, 0, 0, 0, 1, 0,
				0, 0, 0, 0, 0, 0, 0, 1,
				(0.69*31.8 + 0.3*15.68), (0.69*24.28 + 0.3*22.1), (0.69*32.5 + 0.3*30.39), (0.69*14.16 + 0.3*8.93), 
				(0.69*50.99 + 0.3*40.55), (0.69*24.17 + 0.3*18.58), (0.69*23.67 + 0.3*22.54), (0.69*28.77 + 0.3*24.84)), nrow = 9, byrow=TRUE)
dir <- c("<=", "<=", "<=", "<=", "<=", "<=", "<=", "<=", "==")
rhs <- c(75, 75, 75, 75, 75, 75, 75, 75, 10000)
max <- FALSE
Rglpk_solve_LP(obj, mat, dir, rhs, max = max)

#37531.5 - 11062.96
#[1] 26468.54

obj <- c(29.5, 26.31, 34.55, 15.23, 62.43, 26.68, 23.85, 31.66)
mat <- matrix(c(1, 0, 0, 0, 0, 0, 0, 0,
				0, 1, 0, 0, 0, 0, 0, 0,
				0, 0, 1, 0, 0, 0, 0, 0,
				0, 0, 0, 1, 0, 0, 0, 0,
				0, 0, 0, 0, 1, 0, 0, 0,
				0, 0, 0, 0, 0, 1, 0, 0,
				0, 0, 0, 0, 0, 0, 1, 0,
				0, 0, 0, 0, 0, 0, 0, 1,
				(0.69*31.8 + 0.3*15.68), (0.69*24.28 + 0.3*22.1), (0.69*32.5 + 0.3*30.39), (0.69*14.16 + 0.3*8.93), 
				(0.69*50.99 + 0.3*40.55), (0.69*24.17 + 0.3*18.58), (0.69*23.67 + 0.3*22.54), (0.69*28.77 + 0.3*24.84)), nrow = 9, byrow=TRUE)
dir <- c("==", "<=", "<=", "<=", "<=", "<=", "<=", "<=", "==")
rhs <- c(100, 75, 75, 75, 75, 75, 75, 75, 10000)
max <- FALSE
Rglpk_solve_LP(obj, mat, dir, rhs, max = max)

#37531.5 - 11023.97
#[1] 26507.53

# INTEL: 50*((0.69*23.67 + 0.3*22.54))

read.csv("FilatoiRiuniti.csv")

## min 0*A1 + 13.30*A2 + 11.10*A3 + ... + 10.15*G4
## s.t.
## capacity constraints
## demand constraints

ProdCost <- matrix(c(0.0,13.00,10.65,9.60,
				 17.40,14.10,11.20,9.45,
				 17.40,14.22,11.00,9.50,
				 0.0,14.30,11.25,9.60,
				 17.50,13.80,11.40,9.60,
				 18.25,13.90,11.40,8.90,
				 19.75,13.90,10.75,9.40), nrow = 1, byrow = TRUE)

TransCost <- matrix(c(0.0,0.30,0.45,0.45,
					  0.40,0.40,0.60,0.60,
					  0.80,0.80,1.20,1.20,
					  0.0,0.70,1.05,1.05,
					  0.70,0.70,1.05,1.05,
					  0.00,0.00,0.00,0.00,
					  0.50,0.50,0.75,0.75), nrow = 1, byrow = TRUE)

TotalCost <- ProdCost + TransCost

MachineHoursPerKg <- matrix(c(0.0,   0.400,  0.375,  0.250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
							  0, 0, 0, 0, 0.700, 0.500,  0.350,  0.250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
							  0, 0, 0, 0, 0, 0, 0, 0, 0.675, 0.450,  0.400,  0.250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
							  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0,   0.450,  0.350,  0.200, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
							  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.650, 0.450,  0.400,  0.250, 0, 0, 0, 0, 0, 0, 0, 0,
							  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.625, 0.500,  0.425,  0.425, 0, 0, 0, 0,
							  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.700, 0.450,  0.350,  0.400), nrow=7, byrow=TRUE)
							  
Capacity <- c(2500, 3000, 2500, 2600, 2500, 38000, 2500)

KgPerProduct <- matrix(c(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0,
						 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 
						 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0,
						 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1), nrow=4, byrow=TRUE)

Demand <- c(25000, 26000, 28000, 28000)

NoProduce <- matrix(c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
					  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), nrow=2, byrow=TRUE)
						 
obj <- TotalCost
mat <- rbind(MachineHoursPerKg, KgPerProduct, NoProduce)
dir <- c("<=", "<=", "<=", "<=", "<=", "<=", "<=", ">=", ">=", ">=", ">=", "<=", "<=")
rhs <- c(Capacity, Demand, c(0,0))
max <- FALSE

out <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
sol <- as.data.frame(matrix(out$solution, nrow=7, byrow=TRUE))
names(sol) <- c("Extra Fine", "Fine", "Medium", "Coarse")
rownames(sol) <- c("Ambrosi", "Bsolciani", "Castri", "De Blasi", "Estensi", "Filatoi Riuniti", "Giuliani")
sol
sol$Medium
sol$Fine
usedCapacity <- MachineHoursPerKg %*% out$solution
res <- as.data.frame(cbind(usedCapacity, Capacity))
names(res) <- c("usedCapacity", "Capacity")
rownames(res)  <- c("Ambrosi", "Bsolciani", "Castri", "De Blasi", "Estensi", "Filatoi Riuniti", "Giuliani")
res
res[res$usedCapacity == res$Capacity,]

Capacity[6] <- Capacity[6] + 600
rhs <- c(Capacity, Demand, c(0,0))
max <- FALSE
out1 <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)

Capacity[6] <- Capacity[6] - 600
rhs <- c(Capacity, Demand, c(0,0))
max <- FALSE
out <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)

out$optimum - out1$optimum

obj <- c(TotalCost, 0, 0, 5.70, 0)
MachineHoursPerKg <- matrix(c(0.0,   0.400,  0.375,  0.250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
							  0, 0, 0, 0, 0.700, 0.500,  0.350,  0.250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
							  0, 0, 0, 0, 0, 0, 0, 0, 0.675, 0.450,  0.400,  0.250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
							  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0,   0.450,  0.350,  0.200, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
							  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.650, 0.450,  0.400,  0.250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
							  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.625, 0.500,  0.425,  0.425, 0, 0, 0, 0, 0, 0, 0, 0, 
							  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.700, 0.450,  0.350,  0.400, 0, 0, 0, 0, 
							  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  0,  0, 0, 0, 0.425, 0), nrow=8, byrow=TRUE)
Capacity <- c(2500, 3000, 2500, 2600, 2500, 38000, 2500, 300)
KgPerProduct <- matrix(c(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
						 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
						 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0,
						 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0), nrow=4, byrow=TRUE)

NoProduce <- matrix(c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
					  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
					  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
					  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
					  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1), nrow=5, byrow=TRUE)

mat <- rbind(MachineHoursPerKg, KgPerProduct, NoProduce)
dir <- c("<=", "<=", "<=", "<=", "<=", "<=", "<=", "<=", ">=", ">=", ">=", ">=", "<=", "<=", "<=", "<=", "<=")
rhs <- c(Capacity, Demand, c(0,0,0,0,0))
max <- FALSE

out1 <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
out$optimum - out1$optimum

TotalCost[21:24] <- TotalCost[21:24]*105/100
obj <- TotalCost
out1 <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
out$optimum - out1$optimum

TotalCost[21:24] <- TotalCost[21:24]*100/105

TotalCost[21:24] <- TotalCost[21:24]*95/100
obj <- TotalCost
out1 <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
out$optimum - out1$optimum

#12.30*5000
Demand <- c(25000, 26000, 28000 + 6000, 28000)
rhs <- c(Capacity, Demand, c(0,0))
out1 <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
(out1$optimum - out$optimum) / 6000

2600*80/100
2600*120/100
sol

## max (70 * (S1 + S2 + S0.625 0.500  0.425  0.4253) + 60 * (R1 + R2 + R3) + 50 * (D1 + D2 + D3) - 45*(S1 + R1 + D1) - 35*(S2 + R2 + D2) - 25*(S3 + R3 + D3))
## : max                 0.700 0.450  0.350  0.400                      25*S1 + 35*S2 + 45*S3 + 15*R1 + 25*R2 + 35*R3 + 5*D1 + 15*D2 + 25*D3
## s.t.
## 12*S1 + 6*S2 + 8*S3 >= 10*(S1 + S2 + S3) :   2*S1 -  4*S2 -  2*S3 												 >= 0
## 0.5*S1 + 2*S2 + 3*S3 <= 1*(S1 + S2 + S3) : 0.5*S1 -  1*S2 -  2*S3 												 >= 0
## 12*R1 + 6*R2 + 8*R3 >= 8*(R1 + R2 + R3)  :                           4*R1 -  2*R2 + 0*R3							 >= 0 
## 0.5*R1 + 2*R2 + 3*R3 <= 2*(R1 + R2 + R3) :                         1.5*R1 +  0*R2 - 1*R3        					 >= 0
## 12*D1 + 6*D2 + 8*D3 >= 6*(D1 + D2 + D3) :												   6*D1 +  0*D2 +  2*D3	 >= 0    
## 0.5*D1 + 2*D2 + 3*D3 <= 1*(D1 + D2 + D3) :												 0.5*D1 -  1*D2 -  2*D3  >= 0 									
## S1 + R1 + D1 <= 5000                     :   1*S1                 +  1*R1                 + 1*D1            		 <= 5000
## S2 + R2 + D2 <= 5000						:           1*S2                 + 1*R2                 + 1*D2           <= 5000  
## S3 + R3 + D3 <= 5000						:                   1*S3                 + 1*R3				    +  1*D3  <= 5000
## S1 + R1 + D1 + S2 + R2 + D2 + S3 + R3 + D3 <= 14000

obj <- c(25, 35, 45, 15, 25, 35, 5, 15, 25)
mat <- matrix(c(2, -4, -2, 0, 0, 0, 0, 0, 0,
				0.5, -1, -2, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 4, -2, 0, 0, 0, 0,
				0, 0, 0, 1.5, 0, -1, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 6, 0, 2,
				0, 0, 0, 0, 0, 0, 0.5, -1, -2,
				1, 0, 0, 1, 0, 0, 1, 0, 0,
				0, 1, 0, 0, 1, 0, 0, 1, 0,
				0, 0, 1, 0, 0, 1, 0, 0, 1,
				1, 1, 1, 1, 1, 1, 1, 1, 1), nrow = 10, byrow=TRUE)
dir <- c(">=", ">=", ">=", ">=", ">=", ">=", "<=", "<=", "<=", "<=")
rhs <- c(0, 0, 0, 0, 0, 0, 5000, 5000, 5000, 14000)
max <- TRUE
Rglpk_solve_LP(obj, mat, dir, rhs, max = max)

## max (70 * (S1 + S2 + S3) + 60 * (R1 + R2 + R3) + 50 * (D1 + D2 + D3) - 45*(S1 + R1 + D1) - 35*(S2 + R2 + D2) - 25*(S3 + R3 + D3))
## : max                                       25*S1 + 35*S2 + 45*S3 + 15*R1 + 25*R2 + 35*R3 + 5*D1 + 15*D2 + 25*D3
## s.t.
## 12*S1 + 6*S2 + 8*S3 >= 10*(S1 + S2 + S3) :   2*S1 -  4*S2 -  2*S3 												 >= 0
## 0.5*S1 + 2*S2 + 3*S3 <= 1*(S1 + S2 + S3) : 0.5*S1 -  1*S2 -  2*S3 												 >= 0
## 12*R1 + 6*R2 + 8*R3 >= 8*(R1 + R2 + R3)  :                           4*R1 -  2*R2 + 0*R3							 >= 0 
## 0.5*R1 + 2*R2 + 3*R3 <= 2*(R1 + R2 + R3) :                         1.5*R1 +  0*R2 - 1*R3        					 >= 0
## 12*D1 + 6*D2 + 8*D3 >= 6*(D1 + D2 + D3) :												   6*D1 +  0*D2 +  2*D3	 >= 0    
## 0.5*D1 + 2*D2 + 3*D3 <= 1*(D1 + D2 + D3) :												 0.5*D1 -  1*D2 -  2*D3  >= 0 									
## S1 + R1 + D1 <= 5000                     :   1*S1                 +  1*R1                 + 1*D1            		 <= 5000
## S2 + R2 + D2 <= 5000						:           1*S2                 + 1*R2                 + 1*D2           <= 5000  
## S3 + R3 + D3 <= 5000						:                   1*S3                 + 1*R3				    +  1*D3  <= 5000
## S1 + R1 + D1 + S2 + R2 + D2 + S3 + R3 + D3 <= 14000
## S1 + S2 + S3 <= 3000
## R1 + R2 + R3 <= 2000
## D1 + D2 + D3 <= 1000

obj <- c(25, 35, 45, 15, 25, 35, 5, 15, 25)
mat <- matrix(c(2, -4, -2, 0, 0, 0, 0, 0, 0,
				0.5, -1, -2, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 4, -2, 0, 0, 0, 0,
				0, 0, 0, 1.5, 0, -1, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 6, 0, 2,
				0, 0, 0, 0, 0, 0, 0.5, -1, -2,
				1, 0, 0, 1, 0, 0, 1, 0, 0,
				0, 1, 0, 0, 1, 0, 0, 1, 0,
				0, 0, 1, 0, 0, 1, 0, 0, 1,
				1, 1, 1, 1, 1, 1, 1, 1, 1,
				1, 1, 1, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 1, 1, 1, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 1, 1, 1), nrow = 13, byrow=TRUE)
dir <- c(">=", ">=", ">=", ">=", ">=", ">=", "<=", "<=", "<=", "<=", "<=", "<=", "<=")
rhs <- c(0, 0, 0, 0, 0, 0, 5000, 5000, 5000, 14000, 3000, 2000, 1000)
max <- TRUE
Rglpk_solve_LP(obj, mat, dir, rhs, max = max)









read.csv("Week9_AirlineRM_Complete.csv")

# max 617*R + 238*D
# R <= 100
# D <= 150
# R + D <= 166

obj <- c(617, 238)
mat <- matrix(c(1, 0, 0, 1, 1, 1), nrow = 3, byrow=TRUE)
dir <- c("<=", "<=", "<=")
rhs <- c(100, 150, 166)
#rhs <- c(50, 150, 166)
#rhs <- c(200, 150, 166)
#rhs <- c(100, 100, 166)
#rhs <- c(100, 50, 166)
#rhs <- c(150, 150, 250)
rhs <- c(150, 150, 166)
max <- TRUE

obj <- c(428, 190, 642, 224, 512, 190)
mat <- matrix(c(1, 0, 0, 0, 0, 0,
				0, 1, 0, 0, 0, 0,
				0, 0, 1, 0, 0, 0,
				0, 0, 0, 1, 0, 0,
				0, 0, 0, 0, 1, 0,
				0, 0, 0, 0, 0, 1,
				1, 1, 1, 1, 0, 0,
				0, 0, 1, 1, 1, 1), nrow = 8, byrow=TRUE)
dir <- c("<=", "<=", "<=", "<=", "<=", "<=", "<=", "<=")
rhs <- c(80, 120, 75, 100, 60, 110, 166, 166)
max <- TRUE

sol <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)

rhs <- c(80, 120 + 50, 75, 100, 60, 110, 166, 166)
#rhs <- c(80, 120 + 10, 75, 100, 60, 110, 166, 166)
sol1 <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
sol$optimum
sol1$optimum
#rhs <- c(80 + 50, 120, 75, 100, 60, 110, 166, 166)
rhs <- c(80 + 10, 120, 75, 100, 60, 110, 166, 166)
sol1 <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
sol$optimum
sol1$optimum
#sol1$optimum - sol$optimum - 50*200
sol1$optimum - sol$optimum - 10*200

obj <- c(428, 190)
mat <- matrix(c(1, 0, 0, 1, 1, 1), nrow = 3, byrow=TRUE)
dir <- c("<=", "<=", "<=")
rhs <- c(80, 120, 166)
#rhs <- c(90, 120, 166)
rhs <- c(130, 120, 166)
#rhs <- c(50, 150, 166)
#rhs <- c(200, 150, 166)
#rhs <- c(100, 100, 166)
#rhs <- c(100, 50, 166)
#rhs <- c(150, 150, 250)
#rhs <- c(150, 150, 166)
max <- TRUE

Rglpk_solve_LP(obj, mat, dir, rhs, max = max)

# tumor
obj <- c(3, 4.5, 2.5, 1, 2, 4)
#obj <- c(3, 5 + 2.5, 2.5, 1, 5, 4)
#obj <- c(3, 4.5, 2.5, 1, 5, 4)
mat <- matrix(c(2, 0, 0, 0, 1, 0,
				0, 1, 0, 2, 0, 0,
				0, 0, 1.5, 1, 0, 0, 
				0, 0, 1.5, 0, 1, 0,
				0, 2, 0, 0, 2, 0), nrow = 5, byrow=TRUE)
dir <- c(">=", ">=", ">=", ">=", "<=")
rhs <- c(7, 7, 7, 7, 5)
#rhs <- c(7, 7, 7, 7, 6)
max <- FALSE #minimize
sol <- Rglpk_solve_LP(obj, mat, dir, rhs, max = max)
sol$optimum
sum(obj*sol$solution)
obj <- c(3, 4.5, 2.5, 1, 5, 4)
sum(obj*sol$solution)

#22.75+(5-2)*2.5

library(XLConnect)
airlines <- readWorksheet(loadWorkbook("Week9_AirlineRM.xlsx"),sheet=1)

## Simple linear program.
## maximize:   2 x_1 + 4 x_2 + 3 x_3
## subject to: 3 x_1 + 4 x_2 + 2 x_3 <= 60
##             2 x_1 +   x_2 +   x_3 <= 40
##               x_1 + 3 x_2 + 2 x_3 <= 80
##               x_1, x_2, x_3 are non-negative real numbers

obj <- c(2, 4, 3)
mat <- matrix(c(3, 2, 1, 4, 1, 3, 2, 2, 2), nrow = 3)
dir <- c("<=", "<=", "<=")
rhs <- c(60, 40, 80)
max <- TRUE

Rglpk_solve_LP(obj, mat, dir, rhs, max = max)


