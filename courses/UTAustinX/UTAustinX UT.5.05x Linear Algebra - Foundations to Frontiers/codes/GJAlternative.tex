\resetsteps      % Reset all the commands to create a blank worksheet  

% Define the operation to be computed

\renewcommand{\routinename}{ \left[ 
A, B 
\right] := \mbox{\sc GJ\_Inverse\_alt}( 
A, B 
  ) }

% Step 3: Loop-guard 

\renewcommand{\guard}{
  m( A_{TL} ) < m( A )
}

% Step 4: Define Initialize 

\renewcommand{\partitionings}{
  $
A \rightarrow 
\FlaTwoByTwo
  { A_{TL} }{ A_{TR} }
  { A_{BL} }{ A_{BR} },
B \rightarrow 
\FlaTwoByTwo
  { B_{TL} }{ B_{TR} }
  { B_{BL} }{ B_{BR} }
  $
}

\renewcommand{\partitionsizes}{
$ A_{TL} $ is $ 0 \times 0 $,
$ B_{TL} $ is $ 0 \times 0 $
}

% Step 5a: Repartition the operands 

\renewcommand{\repartitionings}{
$  \FlaTwoByTwo{A_{TL}}{A_{TR}}
              {A_{BL}}{A_{BR}}
  \rightarrow
  \FlaThreeByThreeBR{A_{00}}{a_{01}}{A_{02}}
                    {a_{10}^T}{\alpha_{11}}{a_{12}^T}
                    {A_{20}}{a_{21}}{A_{22}}
$,
$  \FlaTwoByTwo{B_{TL}}{B_{TR}}
              {B_{BL}}{B_{BR}}
  \rightarrow
  \FlaThreeByThreeBR{B_{00}}{b_{01}}{B_{02}}
                    {b_{10}^T}{\beta_{11}}{b_{12}^T}
                    {B_{20}}{b_{21}}{B_{22}}
$}

\renewcommand{\repartitionsizes}{
  $ \alpha_{11} $ is $ 1 \times 1 $,
  $ \beta_{11} $ is $ 1 \times 1 $}

% Step 5b: Move the double lines 

\renewcommand{\moveboundaries}{
$  \FlaTwoByTwo{A_{TL}}{A_{TR}}
              {A_{BL}}{A_{BR}}
  \leftarrow
  \FlaThreeByThreeTL{A_{00}}{a_{01}}{A_{02}}
                    {a_{10}^T}{\alpha_{11}}{a_{12}^T}
                    {A_{20}}{a_{21}}{A_{22}}
$,
$  \FlaTwoByTwo{B_{TL}}{B_{TR}}
              {B_{BL}}{B_{BR}}
  \leftarrow
  \FlaThreeByThreeTL{B_{00}}{b_{01}}{B_{02}}
                    {b_{10}^T}{\beta_{11}}{b_{12}^T}
                    {B_{20}}{b_{21}}{B_{22}}
$}

% Step 8: Insert the updates required to change the 
%         state from that given in Step 6 to that given in Step 7
% Note: The below needs editing!!!

\renewcommand{\update}{
$
  \begin{array}{l l}
\begin{array}{@{} c I c | c}
~~~~~~~~~&     a_{01} := a_{01} / \alpha_{11} &    A_{02} := A_{02} - a_{01}
a_{12}^T  \\ \whline
~~~ & ~~~ & ~~~ \\ \hline
~~~&    a_{21} := a_{21} / \alpha_{11} &
    A_{22} := A_{22} - a_{21} a_{12}^T \\
\multicolumn{3}{l}{
\mbox{(Note: above $ a_{01} $ and $ a_{21} $ must be updated}} \\ 
\multicolumn{3}{l}{
 \mbox{before the operations to their right.)}
}
\\
& a_{01} := 0 & \\ \whline
& \alpha_{11} := 1 & a_{12}^T := a_{12}^T / \alpha_{11} \\ \hline
& a_{21} := 0 & 
\\
\multicolumn{3}{l}{
\mbox{(Note: above $ \alpha_{11} $ must be updated 
  last.)}
}
\end{array} 
~~~~~~~~~~~~
\begin{array}{@{} c I c | c}
 B_{00} := B_{00} - a_{01} b_{10}^T &     b_{01} := - a_{01} & ~~~ \\ \whline
~~~~~~~~~ & ~~~ & ~~~ \\ \hline
 B_{20} := B_{20} - a_{21}  b_{10}^T 
&    b_{21} := - a_{21} & ~~~\\
\multicolumn{3}{l}{
\phantom{\mbox{(Note: $ \alpha_{11} $ must be updated 
  last.)}}} \\
\multicolumn{3}{l}{
\phantom{\mbox{(Note: $ \alpha_{11} $ must be updated 
  last.)}}} \\
& & \\ \whline
b_{10}^T := b_{10}^T / \alpha_{11} & \beta_{11} = 1 / \alpha_{11} & \\ \hline
& &  \\
\multicolumn{3}{l}{
\phantom{\mbox{(Note: $ \alpha_{11} $ must be updated 
  last.)}}
}
\end{array} 
  \end{array}
$
}


